# T5APR: Empowering Automated Program Repair across Languages through Checkpoint Ensemble
[![arXiv](https://img.shields.io/badge/arXiv-2309.15742-b31b1b.svg)](https://arxiv.org/abs/2309.15742)
[![Hugging Face Collection](https://img.shields.io/badge/ðŸ¤—_Collection-Data_&_Model-ffd21e.svg)](https://huggingface.co/collections/h4iku/t5apr-6514a09a8f20a8ccf7b07f5d)

![T5APR overview](T5APR.png)

T5APR is a novel approach to automated program repair (APR) that leverages a multilingual transformer model based on CodeT5 along with a checkpoint ensemble strategy to generate patches for programs written in Python, Java, C, and JavaScript.

## Repository Structure

### `results`:

This directory contains generated plausible patches for each benchmark. The `outputs-multi` directories holds patches generated by the multilingual model, while the `outputs-{language}` directories contain patches produced by models trained on a single language.


## How to Run

1. Install Python 3.9 or higher and clone this repository:

    ```bash
    git clone --recurse-submodules https://github.com/h4iku/T5APR.git
    cd T5APR
    ```

2. Create a virtual environment and install the dependencies:

    ```bash
    python -m venv .env
    source .env/bin/activate

    python -m pip install -U pip setuptools
    pip install -r requirements.txt
    ```

3. Evaluation benchmarks and language grammars:

    - Place the evaluation benchmarks in the `datasets` directory.
    - Follow the [tree-sitter](https://github.com/tree-sitter/py-tree-sitter) instructions to clone the required language grammars into the `tools` directory.

4. To run each module, navigate to the root of the repository and execute the following command:

    ```bash
    python -m package.module
    ```

    For example, to run the `find_bugline_quixbugs_python.py` module:

    ```bash
    python -m src.find_bugline_quixbugs_python
    ```

    To run tests:

    ```bash
    python -m pytest tests
    ```


## Citation

If you use T5APR in your research, please cite the following paper:

```bibtex
@misc{gharibiT5APREmpoweringAutomated2023,
  title = {T5APR: Empowering Automated Program Repair across Languages through Checkpoint Ensemble},
  shorttitle = {T5APR},
  author = {Gharibi, Reza and Sadreddini, Mohammad Hadi and Fakhrahmad, Seyed Mostafa},
  year = {2023},
  number = {arXiv:2309.15742},
  eprint = {2309.15742},
  primaryclass = {cs.SE},
  doi = {10.48550/arXiv.2309.15742},
  archiveprefix = {arxiv},
}
```